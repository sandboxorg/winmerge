<sect1 id="Installing">
  <title>Getting and installing WinMerge</title>
  <sect2>
    <title>Getting files</title>
    <para>Latest releases can be always downloaded from WinMerge homepage: <ulink url="http://www.winmerge.org/">WinMerge.org</ulink>. Note that there may be some delay updating homepages for releases, but project statuspage at <ulink url="https://sourceforge.net/projects/winmerge/">SourceForge.net</ulink> shows latest files. There is also mailing-list for release announcements. Stable releases are also available in several file download sites.</para>
    <para>WinMerge can be installed using installer or by unzipping files from archive.</para>
  </sect2>
  <sect2>
    <title>Using installer (recommended)</title>
    <para>This is recommeded for most users. Installer asks location where WinMerge is installed, installs files, configures shell integration and adds WinMerge to <guimenu>Start</guimenu>-menu. To install WinMerge:</para>
    <orderedlist>
      <listitem>
        <para>Start installer executable (usually named <filename>WinMerge-<replaceable>version</replaceable>-setup.exe</filename>)</para>
      </listitem>
      <listitem>
        <para>Select <guibutton>Next</guibutton>-button in welcome screen</para>
      </listitem>
      <listitem>
        <para>Select <guibutton>Next</guibutton>-button in licence screen</para>
      </listitem>
      <listitem>
        <para>Select location for WinMerge and select <guibutton>Next</guibutton>-button. It is recommended to install WinMerge in own directory.</para>
      </listitem>
      <listitem>
        <para>Select components installed or one of preconfigured combinations. <guilabel>Typical</guilabel> configuration is recommended for most users. In addition to components already selected by <guilabel>Typical</guilabel>, language file(s) could be choosed. Components are:</para>
        <itemizedlist>
          <listitem>
            <para><guilabel>WinMerge core files</guilabel> - cannot be unselected - WinMerge executable files</para>
          </listitem>
          <listitem>
            <para><guilabel>Application Runtimes</guilabel> - cannot be unselected - needed DLL files</para>
          </listitem>
          <listitem>
            <para><guilabel>User's Guide</guilabel> - HTML user guide/manual - if it is not installed WinMerge opens manual from <ulink url="http://www.winmerge.org/">WinMerge.org</ulink></para>
          </listitem>
          <listitem>
            <para><guilabel>Filters</guilabel> - file filter files</para>
          </listitem>
          <listitem>
            <para><guilabel>Plugins</guilabel> - plugins and scripts</para>
          </listitem>
          <listitem>
            <para><guilabel>Languages</guilabel> - WinMerge translation files. After installing translation file user interface language can be selected from menu <menuchoice><guimenu>View</guimenu><guimenuitem>Language</guimenuitem></menuchoice>.</para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para>Select <guimenu>Start</guimenu>-menu folder or disable creating it.</para>
      </listitem>
      <listitem>
        <para>Select additional tasks:<itemizedlist>
            <listitem>
              <para><guilabel>Enable Explorer context menu integration</guilabel> - Enables basic WinMerge shell integration (can be later enabled from options).</para>
            </listitem>
            <listitem>
              <para><guilabel>Integrate with TortoiseCVS</guilabel> - sets WinMerge to TortoiseCVS diff application.</para>
            </listitem>
            <listitem>
              <para><guilabel>Create a Desktop Icon</guilabel> - adds WinMerge icon to Desktop</para>
            </listitem>
            <listitem>
              <para><guilabel>Create a Quick Launch Icon</guilabel> - adds WinMerge icon to Quick Launch bar</para>
            </listitem>
          </itemizedlist></para>
      </listitem>
      <listitem>
        <para>Verify install selections and select <guibutton>Install</guibutton> button to continue.</para>
      </listitem>
      <listitem>
        <para>After installer has copied files final screen appears with two checkboxes asking if created WinMerge Start-menu folder should be opened and if WinMerge application should be started.</para>
      </listitem>
    </orderedlist>
  </sect2>
  <sect2>
    <title>Unzipping from archive</title>
    <para>This is for experienced users. Archive files are smaller to download and faster to install.</para>
    <para>WinMerge is pretty much independent from other system components. WinMerge doesn't integrate tightly to Windows or use lots of dlls. <filename>WinMerge[U].exe</filename> itself is dependent of <filename>MFC42[U].dll</filename> (and <filename>MSVCRT.dll</filename>) in addition to some system DLLs. So if mentioned DLLs already are installed to system, only <filename>WinMerge[U].exe</filename> is needed to run WinMerge.</para>
  </sect2>
  <sect2>
    <title>Shell integration</title>
    <para>Choose "<guilabel>Enable Explorer context menu integration</guilabel>" from installer's additional features to install shell integration.</para>
    <para>If install program is not used, shell integration dll (<filename>ShellExtension.dll</filename>) must be registered separately. This is done by running <filename>register.bat</filename> from WinMerge directory.</para>
    <para>Updating shell integreation outside installer requires first uninstalling current version. Uninstalling can be done by running <filename>uninstall.bat</filename> from WinMerge directory. After that computer should be restarted so Windows completes uninstallation. Then new version can be installed like described above.</para>
  </sect2>
  <sect2>
    <title>7-Zip and archive support</title>
    <para>Archive file support in WinMerge requires 7-Zip. WinMerge installer does not install 7-Zip. 7-Zip installer can be downloaded from <ulink url="http://www.7-zip.org/">7-Zip.org</ulink>.</para>
    <para>WinMerge automatically detects installed 7-zip in system, there is no need to any configuration. But WinMerge supports only certain versions of 7-Zip. Please check 7-zip version compatibility from <filename>Read Me.rft</filename>-file. </para>
    <para>7-zip integration needs compatible <filename>Merge7z*.dll</filename> in WinMerge program directory. <filename>*</filename> comes from 7-zip version installed. For example 7-zip version 3.13 needs <filename>Merge7z313.dll</filename>. And if <filename>WinMergeU.exe</filename> (unicode version) is used, then "<filename>U</filename>" is also added to filename: <filename>Merge7z313U.dll</filename>. <filename>Merge7z*.dll</filename> files for compatible 7-zip versions are installed by WinMerge installer. If needed dll file is for some reason missing it can be copied to WinMerge directory, for example from zip-archive downloadable in WinMerge download page.</para>
    <para>If <filename>Merge7z*.dll</filename> file is missing, WinMerge informs user with message showing filename of needed file and recommended version of 7-zip. This message can also be opened from <guimenu>Help</guimenu>-menu item "<guimenuitem>Archive Support Disabled</guimenuitem>".</para>
  </sect2>
</sect1>
