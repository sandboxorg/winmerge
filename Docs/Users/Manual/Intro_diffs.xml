<?xml version="1.0" encoding="UTF-8"?>
<sect1 id="IntroDiff">
  <title>Overview of file comparing and merging</title>

  <para>This topic introduces the concept of differences in files, how WinMerge displays differences in the File Compare window, and how you can merge differences between files.</para>

  <sect2>
    <title>What are file differences?</title>

    <para>If you compare two files, you can probably easily identify several types of differences: different characters and words, different lines, even entire blocks of text that are different. A spell checker is a commonly-used utility that handles simple differences: it highlights words in a document that are different from those in its stored dictionary. You step through the document, resolving each highlighted word in turn.</para>

    <para>However, looking only at characters and words is not an effective way to do more complicated comparisons. For this reason, many text utilities use lines as the basic unit of comparison instead. WinMerge's compare engine also uses lines as the basic unit for comparing and merging. WinMerge detects smaller differences, but they are not the basis for comparing and merging operations. To illustrate: if two files have identical lines except for one line, and that line has five words that are different, then we say that the file has one difference, not five.</para>

    <para>It's simple to compare files by identifying single lines that are different. But what it your files have many consecutive different lines? WinMerge handles the entire block of lines as a single difference. This makes it easier for you to step through files and identify their differences. As we will see later, it makes merging quicker too.</para>

    <para>Let's look at a simple example that shows what we have discussed so far. First, examine these two files:</para>

    <informalexample>
      <formalpara>
        <title>File1</title>

        <para><screen>It's hard to compare words
and merge them. So instead 
WinMerge compares lines.
Believe it or else.</screen></para>
      </formalpara>

      <formalpara>
        <title>File2</title>

        <para><screen>It's hard to compare words.
WinMerge compares lines.
Believe it or not.</screen></para>
      </formalpara>
    </informalexample>

    <para>If we open these two files in WinMerge, here is how they initially display in the File Compare window:</para>

    <mediaobject>
      <imageobject>
        <imagedata contentwidth="593" fileref="screenshots/missing_lines.png" />
      </imageobject>

      <textobject>
        <phrase>Compare Files screen shot</phrase>
      </textobject>
    </mediaobject>

    <para>Notice the status message at the bottom right of the window: It tells you that two differences were detected. Can you identify them? The File Compare window indicates differences by adding a background color (which you can customize) to the text. </para>

    <para>The following notes explain each of the callout numbers in the screenshot:</para>

    <orderedlist>
      <listitem>
        <para>The first difference is a multiline difference: it compares lines 1 and 2 on the left with line 1 on the right.</para>

        <para>Dark gold is the default background color that identifies <glossterm>line differences</glossterm>. Also notice the second, lighter color within the differences. This color identifies <glossterm>word differences</glossterm>: the specific words and spaces within the lines that are different.</para>
      </listitem>

      <listitem>
        <para>In the right pane, difference 1 includes an empty line with a gray background. We know that line 2 in <filename>File2</filename> is</para>

        <programlisting>WinMerge compares lines.</programlisting>

        <para>Because this line is not part of difference 1, WinMerge inserts a blank line in its place. It then moves the line down so that it aligns with its matching line in the left pane (which happens to be line 3 in <filename>File1</filename>. If you understand this principle, you can always tell which lines WinMerge is comparing.</para>

        <para>Empty gray lines are ignored, and are not part of the source file. What do you think happens if you enter text in an empty gray line? You are adding content to the source file, and the gray background disappears from the line to which you add text.</para>

        <tip>
          <para>One consequence of this alignment method is that both panes in the File Compare window always display the same number of lines, even if their source files do not.</para>
        </tip>
      </listitem>

      <listitem>
        <para>This line is not highlighted because it is identical in both files, and does not need merging. As with differences, the WinMerge display aligns matching lines even when they occur in different places in the source files.</para>
      </listitem>

      <listitem>
        <para>The last line is difference 2. Again, we know it is a difference because of its gold background color. Can you identify the specific word differences?</para>
      </listitem>
    </orderedlist>
  </sect2>

  <sect2>
    <title>What is file merging?</title>

    <para>After you compare two files in the File Compare window, you might want to merge them. In WinMerge, merging is nothing more than copying differences from one file to the other. If a difference includes multiple lines, all of them are copied at once.</para>

    <para>WinMerge provides controls in the toolbar that make it easy to navigate through the differences, and to merge selected differences (or even all differences) in either direction.</para>

    <para>Let's show how you can use the controls in the File Compare window to merge the simple files shown earlier. You can perform the following merge operation using only four mouse clicks:</para>

    <orderedlist>
      <listitem>
        <para>Click <inlinemediaobject>
            <imageobject>
              <imagedata contentwidth="16" fileref="screenshots/nextdiff_btn.png" />
            </imageobject>

            <textobject>
              <phrase>Next Difference button</phrase>
            </textobject>
          </inlinemediaobject> <guibutton>Next Difference</guibutton> to select difference 1.</para>
      </listitem>

      <listitem>
        <para>Click <inlinemediaobject>
            <imageobject>
              <imagedata contentwidth="17" fileref="screenshots/copyr_button.png" />
            </imageobject>

            <textobject>
              <phrase>Copy Right button</phrase>
            </textobject>
          </inlinemediaobject> <guibutton>Copy Right</guibutton> to merge difference 1 from <filename>File1</filename> to <filename>File2</filename>. In <filename>File</filename> 2, notice that the single difference line is replaced by the two lines from <filename>File1</filename>, and the gray empty line is now gone.</para>
      </listitem>

      <listitem>
        <para>Click <guibutton>Next Difference</guibutton> again to select difference 2. This is easier than finding and selecting the difference yourself. It's especially useful if you want to step through all differences without accidentally missing any. </para>
      </listitem>

      <listitem>
        <para>Click <inlinemediaobject>
            <imageobject>
              <imagedata contentwidth="17" fileref="screenshots/copyl_button.png" />
            </imageobject>

            <textobject>
              <phrase>Copy Left button</phrase>
            </textobject>
          </inlinemediaobject> <guibutton>Copy Left</guibutton> to merge difference 2 from <filename>File2</filename> to <filename>File1</filename>.</para>
      </listitem>
    </orderedlist>

    <para>Here is the result of our merge:</para>

    <informalexample>
      <mediaobject>
        <imageobject>
          <imagedata contentwidth="573" fileref="screenshots/filemerged1.png" format="PNG" />
        </imageobject>
      </mediaobject>
    </informalexample>

    <para>Remember that in addition to its specialized comparing and merging functions, the File Compare window also enables you to edit your files directly using its conventional editing functions (including searching, copying and pasting text).</para>
  </sect2>
</sect1>
